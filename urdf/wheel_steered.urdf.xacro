<?xml version="1.0"?>
<robot
    xmlns:xacro="http://ros.org/wiki/xacro"
    name="wheel_steered">

  <xacro:property
      name="steering_mass_radius"
      value="0.1" />
  <xacro:property
      name="steering_link_mass"
      value="10.0" />

  <xacro:macro
      name="wheel_steered"
      params="prefix parent_link left_right *origin">
    <link name="${prefix}_axle">
      <visual>
        <origin
            xyz="0 0 0"
            rpy="${pi/2} 0 0" />
        <geometry>
          <mesh filename="package://metron_p48_description/media/models/wheels/motor.dae" />
        </geometry>
        <material name="gray">
          <color rgba="0.4 0.4 0.4 1.0" />
        </material>
      </visual>
      <collision>
        <geometry>
          <sphere radius="0.2" />
        </geometry>
      </collision>
      <xacro:sphere_inertial_with_origin
          radius="${steering_mass_radius}"
          mass="${steering_link_mass}">
        <origin xyz="0 ${-0.1 * left_right} 0" />
      </xacro:sphere_inertial_with_origin>
    </link>

    <joint
        name="${prefix}_kingpin"
        type="revolute">
      <limit
          lower="-0.6109"
          upper="0.6109"
          effort="4000"
          velocity="1.4" />
      <axis xyz="0 0 1" />
      <parent link="${parent_link}" />
      <child link="${prefix}_axle" />
      <xacro:insert_block name="origin" />
      <dynamics friction="0" />
      <gazebo>
        <physics>
          <ode>
            <cfm_damping>1</cfm_damping>
          </ode>
        </physics>
      </gazebo>
    </joint>
  </xacro:macro>
</robot>
